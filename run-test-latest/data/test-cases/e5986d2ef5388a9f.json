{"uid":"e5986d2ef5388a9f","name":"Add user not in organization to project via CLI","fullName":"tests.test_cases.tests_cli.test_project_structure_setup.TestCLIProjectStructureSetup#test_add_user_not_in_org_to_proj_cli","historyId":"7801d78bb3a65d526571af74c312a3a2","time":{"start":1759158937592,"stop":1759158973728,"duration":36136},"description":"\n- Login with valid credentials via **UI**.\n- Get Bearer auth token from Playwright local storage.\n- Create new organization via **API**.\n- Signup `second user` via **UI**.\n- Login with Bearer auth token via **CLI**.\n- Create new project via **CLI**.\n\n### Verify that:\n\n- User **cannot** add registered user **not from organization** to project via **CLI**.\n","descriptionHtml":"<div style='line-height:1.6;'><ul>\n<li>Login with valid credentials via <strong>UI</strong>.</li>\n<li>Get Bearer auth token from Playwright local storage.</li>\n<li>Create new organization via <strong>API</strong>.</li>\n<li>Signup <span style='background-color:#D3D3D3; padding:2px 4px; border-radius:3px; font-family:monospace;'>second user</span> via <strong>UI</strong>.</li>\n<li>Login with Bearer auth token via <strong>CLI</strong>.</li>\n<li>Create new project via <strong>CLI</strong>.</li>\n</ul>\n<h3>Verify that:</h3>\n<ul>\n<li>User <strong>cannot</strong> add registered user <strong>not from organization</strong> to project via <strong>CLI</strong>.</li>\n</ul></div>","status":"failed","statusMessage":"AssertionError: [AssertionError] during step: Add organization via API and reload page\nMessage: Expected HTTP 201 response but got 504!","statusTrace":"tests/reporting_hooks/reporting.py:49: in wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\ntests/test_cases/steps/ui_steps/ui_steps.py:372: in ui_add_org_api\n    assert status == 201, f\"Expected HTTP 201 response but got {status}!\"\n           ^^^^^^^^^^^^^\nE   AssertionError: Expected HTTP 201 response but got 504!\n\nThe above exception was the direct cause of the following exception:\ntests/test_cases/tests_cli/test_project_structure_setup.py:261: in test_add_user_not_in_org_to_proj_cli\n    await self._ui_steps.ui_add_org_api(\ntests/reporting_hooks/reporting.py:58: in wrapper\n    raise AssertionError(formatted_msg) from e\nE   AssertionError: [AssertionError] during step: Add organization via API and reload page\nE   Message: Expected HTTP 201 response but got 504!","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":2,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1759153330442,"stop":1759153330442,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1759153330442,"stop":1759153330442,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop_policy","time":{"start":1759153330442,"stop":1759153330442,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delay_worker_start","time":{"start":1759153330443,"stop":1759153330443,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1759153330443,"stop":1759153330443,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1759153330443,"stop":1759153330443,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ensure_storage_directories","time":{"start":1759153330443,"stop":1759153330443,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_config","time":{"start":1759158933877,"stop":1759158933881,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_function_scoped_runner","time":{"start":1759158933881,"stop":1759158933881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page_manager","time":{"start":1759158933881,"stop":1759158936973,"duration":3092},"status":"passed","steps":[],"attachments":[{"uid":"b3ed905a57372edb","name":"HTTP 200 - GET config","source":"b3ed905a57372edb.txt","type":"text/plain","size":654}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"users_manager","time":{"start":1759158936973,"stop":1759158936973,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"data_manager","time":{"start":1759158936973,"stop":1759158936973,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_helper","time":{"start":1759158936973,"stop":1759158936974,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_cleanup","time":{"start":1759158936974,"stop":1759158936975,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"apolo_cli","time":{"start":1759158936974,"stop":1759158936974,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup","time":{"start":1759158936975,"stop":1759158937592,"duration":617},"status":"passed","steps":[{"name":"Verify Apolo CLI client is installed","time":{"start":1759158936975,"stop":1759158937592,"duration":617},"status":"passed","steps":[],"attachments":[{"uid":"dc466ee9ca07aa2c","name":"Executed CLI command","source":"dc466ee9ca07aa2c.txt","type":"text/plain","size":15},{"uid":"e903c448ff264e42","name":"Executed CLI command output","source":"e903c448ff264e42.txt","type":"text/plain","size":28}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"add_page_manager","time":{"start":1759158936975,"stop":1759158936975,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_inject_fixtures","time":{"start":1759158936975,"stop":1759158936975,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n- Login with valid credentials via **UI**.\n- Get Bearer auth token from Playwright local storage.\n- Create new organization via **API**.\n- Signup `second user` via **UI**.\n- Login with Bearer auth token via **CLI**.\n- Create new project via **CLI**.\n\n### Verify that:\n\n- User **cannot** add registered user **not from organization** to project via **CLI**.\n","descriptionHtml":"<div style='line-height:1.6;'><ul>\n<li>Login with valid credentials via <strong>UI</strong>.</li>\n<li>Get Bearer auth token from Playwright local storage.</li>\n<li>Create new organization via <strong>API</strong>.</li>\n<li>Signup <span style='background-color:#D3D3D3; padding:2px 4px; border-radius:3px; font-family:monospace;'>second user</span> via <strong>UI</strong>.</li>\n<li>Login with Bearer auth token via <strong>CLI</strong>.</li>\n<li>Create new project via <strong>CLI</strong>.</li>\n</ul>\n<h3>Verify that:</h3>\n<ul>\n<li>User <strong>cannot</strong> add registered user <strong>not from organization</strong> to project via <strong>CLI</strong>.</li>\n</ul></div>","status":"failed","statusMessage":"AssertionError: [AssertionError] during step: Add organization via API and reload page\nMessage: Expected HTTP 201 response but got 504!","statusTrace":"tests/reporting_hooks/reporting.py:49: in wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\ntests/test_cases/steps/ui_steps/ui_steps.py:372: in ui_add_org_api\n    assert status == 201, f\"Expected HTTP 201 response but got {status}!\"\n           ^^^^^^^^^^^^^\nE   AssertionError: Expected HTTP 201 response but got 504!\n\nThe above exception was the direct cause of the following exception:\ntests/test_cases/tests_cli/test_project_structure_setup.py:261: in test_add_user_not_in_org_to_proj_cli\n    await self._ui_steps.ui_add_org_api(\ntests/reporting_hooks/reporting.py:58: in wrapper\n    raise AssertionError(formatted_msg) from e\nE   AssertionError: [AssertionError] during step: Add organization via API and reload page\nE   Message: Expected HTTP 201 response but got 504!","steps":[{"name":"Login via UI","time":{"start":1759158937593,"stop":1759158943562,"duration":5969},"status":"passed","steps":[{"name":"Click login button","time":{"start":1759158937593,"stop":1759158938768,"duration":1175},"status":"passed","steps":[],"attachments":[{"uid":"f207107734cbdc98","name":"Page URL","source":"f207107734cbdc98.txt","type":"text/plain","size":33},{"uid":"36314aa9c2c1204a","name":"Screenshot: Click login button (success)","source":"36314aa9c2c1204a.png","type":"image/png","size":42231}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"Enter email","time":{"start":1759158938769,"stop":1759158939127,"duration":358},"status":"passed","steps":[],"attachments":[{"uid":"988610e6f3f3dead","name":"Page URL","source":"988610e6f3f3dead.txt","type":"text/plain","size":215},{"uid":"aa4f06823cc5cd32","name":"Screenshot: Enter email (success)","source":"aa4f06823cc5cd32.png","type":"image/png","size":45975}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"Enter password","time":{"start":1759158939127,"stop":1759158939477,"duration":350},"status":"passed","steps":[],"attachments":[{"uid":"26ea5c10ab9d2488","name":"Page URL","source":"26ea5c10ab9d2488.txt","type":"text/plain","size":215},{"uid":"8fbf14be33032d92","name":"Screenshot: Enter password (success)","source":"8fbf14be33032d92.png","type":"image/png","size":46100}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"Click Continue button","time":{"start":1759158939477,"stop":1759158942288,"duration":2811},"status":"passed","steps":[],"attachments":[{"uid":"b89b2a05b8064a2f","name":"Page URL","source":"b89b2a05b8064a2f.txt","type":"text/plain","size":215},{"uid":"3997d5f87f87a0af","name":"HTTP 200 - GET config","source":"3997d5f87f87a0af.txt","type":"text/plain","size":752},{"uid":"872b8a721f359d61","name":"HTTP 200 - GET regression-9psmlvoy2n?include=clusters&include=system_role","source":"872b8a721f359d61.txt","type":"text/plain","size":388},{"uid":"adf4fc2b2af0794","name":"HTTP 200 - GET permissions?uri=blob:","source":"adf4fc2b2af0794.txt","type":"text/plain","size":163},{"uid":"e54e256e9975e8ad","name":"HTTP 200 - GET incoming","source":"e54e256e9975e8ad.txt","type":"text/plain","size":137},{"uid":"e57f1f61e693df5e","name":"HTTP 200 - GET regression-9psmlvoy2n?include=orgs","source":"e57f1f61e693df5e.txt","type":"text/plain","size":360},{"uid":"540626d17fb7c50","name":"Screenshot: Click Continue button (success)","source":"540626d17fb7c50.png","type":"image/png","size":51381}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":7,"hasContent":true,"attachmentStep":false},{"name":"Verify that Welcome new user page displayed","time":{"start":1759158942299,"stop":1759158943420,"duration":1121},"status":"passed","steps":[],"attachments":[{"uid":"2374e7b86491ceed","name":"Page URL","source":"2374e7b86491ceed.txt","type":"text/plain","size":44},{"uid":"ce649028410a8fd5","name":"Screenshot: Verify that Welcome new user page displayed (success)","source":"ce649028410a8fd5.png","type":"image/png","size":160214}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"573fc97dcec819a2","name":"Page URL","source":"573fc97dcec819a2.txt","type":"text/plain","size":33},{"uid":"beba05c7e477cf0d","name":"Screenshot: Login via UI (success)","source":"beba05c7e477cf0d.png","type":"image/png","size":160214}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":5,"attachmentsCount":17,"hasContent":true,"attachmentStep":false},{"name":"Add organization via API and reload page","time":{"start":1759158943562,"stop":1759158973727,"duration":30165},"status":"failed","statusMessage":"AssertionError: [AssertionError] during step: Add organization via API and reload page\nMessage: Expected HTTP 201 response but got 504!\n","statusTrace":"  File \"/home/runner/work/apolo-test-automation/apolo-test-automation/tests/reporting_hooks/reporting.py\", line 58, in wrapper\n    raise AssertionError(formatted_msg) from e\n","steps":[],"attachments":[{"uid":"9c9998c239c3baf4","name":"Page URL","source":"9c9998c239c3baf4.txt","type":"text/plain","size":44},{"uid":"5ef3f78a3f526f7b","name":"Screenshot: Add organization via API and reload page (fail)","source":"5ef3f78a3f526f7b.png","type":"image/png","size":160214}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"a2399aa158ef6af4","name":"log","source":"a2399aa158ef6af4.txt","type":"text/plain","size":31713}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":7,"attachmentsCount":20,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"add_page_manager::finalizer","time":{"start":1759158973744,"stop":1759158973744,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_cleanup::finalizer","time":{"start":1759158973744,"stop":1759158973744,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_cleanup::finalizer","time":{"start":1759158973744,"stop":1759158978224,"duration":4480},"status":"passed","steps":[{"name":"Post-test cleanup","time":{"start":1759158973744,"stop":1759158978223,"duration":4479},"status":"passed","steps":[],"attachments":[{"uid":"340d70302f0b7077","name":"Cleanup note","source":"340d70302f0b7077.txt","type":"text/plain","size":29}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"api_helper::finalizer","time":{"start":1759158978224,"stop":1759158978225,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_function_scoped_runner::0","time":{"start":1759158978226,"stop":1759158978228,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"suite","value":"CLI Project Structure Setup"},{"name":"parentSuite","value":"CLI Tests"},{"name":"tag","value":"asyncio"},{"name":"subSuite","value":"TestCLIProjectStructureSetup"},{"name":"host","value":"runnervm3ublj"},{"name":"thread","value":"3593-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_cases.tests_cli.test_project_structure_setup"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"23e36dc7cf50c5fe","status":"failed","statusDetails":"AssertionError: [AssertionError] during step: Login via UI\nMessage: [AssertionError] during step: Verify that Welcome new user page displayed\nMessage: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for locator(\"h3.truncate.text-h3\").filter(has_text=\"Welcome, regression-9psmlvoy2n@apolo.us\")","time":{"start":1759158905397,"stop":1759158917013,"duration":11616}},{"uid":"9457917cf75e8463","status":"failed","statusDetails":"AssertionError: [AssertionError] during step: Add organization via API and reload page\nMessage: Expected HTTP 201 response but got 504!","time":{"start":1759158850711,"stop":1759158888330,"duration":37619}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":23,"broken":0,"skipped":0,"passed":32,"unknown":0,"total":55},"items":[{"uid":"2d4a4b8200d7ec01","status":"passed","time":{"start":1759115385632,"stop":1759115431395,"duration":45763}},{"uid":"53adf47ce49b2ded","status":"passed","time":{"start":1759029127784,"stop":1759029176005,"duration":48221}},{"uid":"616be44e78d3a0b","status":"passed","time":{"start":1758942648227,"stop":1758942687322,"duration":39095}},{"uid":"8063c94a50b819e1","status":"passed","time":{"start":1758855278980,"stop":1758855312434,"duration":33454}},{"uid":"7d99b9047966570f","status":"passed","time":{"start":1758769088778,"stop":1758769133956,"duration":45178}},{"uid":"4840cf152bfa4706","status":"passed","time":{"start":1758710805643,"stop":1758710847227,"duration":41584}},{"uid":"7dabbde1eb01006e","status":"passed","time":{"start":1758695571618,"stop":1758695602612,"duration":30994}},{"uid":"9f94c502bf6aeeee","status":"passed","time":{"start":1758684001159,"stop":1758684053167,"duration":52008}},{"uid":"92be320a67df12ea","status":"passed","time":{"start":1758596125186,"stop":1758596168012,"duration":42826}},{"uid":"f6548bba248258e9","status":"passed","time":{"start":1758509707268,"stop":1758509755100,"duration":47832}},{"uid":"78f5e57a84112fe0","status":"passed","time":{"start":1758423422910,"stop":1758423463798,"duration":40888}},{"uid":"3257923d82d88faa","status":"passed","time":{"start":1758337164553,"stop":1758337206853,"duration":42300}},{"uid":"adef05230bd862f8","status":"passed","time":{"start":1758250585508,"stop":1758250632769,"duration":47261}},{"uid":"9396f3194ab9972b","status":"passed","time":{"start":1758163979559,"stop":1758164034200,"duration":54641}},{"uid":"3f85603e4451b73c","status":"passed","time":{"start":1758107484284,"stop":1758107525711,"duration":41427}},{"uid":"76833bd783184180","status":"failed","statusDetails":"AssertionError: [AssertionError] during step: Add new project via apolo CLI\nMessage: ERROR: Illegal argument(s) (upstream request timeout)","time":{"start":1758087407247,"stop":1758087469241,"duration":61994}},{"uid":"b2af7299fe24416f","status":"failed","statusDetails":"AssertionError: [AssertionError] during step: Login via UI\nMessage: [AssertionError] during step: Verify that Welcome new user page displayed\nMessage: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for locator(\"h3.truncate.text-h3\").filter(has_text=\"Welcome, regression-hu30kslfn7@apolo.us\")","time":{"start":1757992000828,"stop":1757992016791,"duration":15963}},{"uid":"279a14227fa405b4","status":"passed","time":{"start":1757906759602,"stop":1757906790008,"duration":30406}},{"uid":"bb9acec11d513d72","status":"passed","time":{"start":1757818156027,"stop":1757818201726,"duration":45699}},{"uid":"28f84debc2fd9a49","status":"passed","time":{"start":1757731959916,"stop":1757731990133,"duration":30217}}]},"tags":["asyncio"]},"source":"e5986d2ef5388a9f.json","parameterValues":[]}